def grade_student():
    print("Welcome to the Student Grading Assistant")
    name = input("Enter Student Name: ")
    num_subjects = int(input("Enter number of subjects: "))

    subjects = {}
    total = 0
    for i in range(num_subjects):
        subject = input(f"Enter subject {i+1} name: ")
        marks = float(input(f"Enter marks in {subject} (out of 100): "))
        subjects[subject] = marks
        total += marks
    average = total / num_subjects
    if average >= 90:
        grade = "A+"
        remark = "Excellent Performance!"
    elif average >= 75:
        grade = "A"
        remark = "Very Good, keep it up!"
    elif average >= 60:
        grade = "B"
        remark = "Good, but you can improve."
    elif average >= 50:
        grade = "C"
        remark = "Needs Improvement."
    else:
        grade = "Fail"
        remark = "Work harder next time."
    highest_subject = max(subjects, key=subjects.get)
    lowest_subject = min(subjects, key=subjects.get)
    print("\nStudent Report")
    print(f"Name: {name}")
    for sub, mark in subjects.items():
        print(f"{sub}: {mark}")
    print(f"Average Marks: {average:.2f}")
    print(f"Final Grade: {grade}")
    print(f"Remarks: {remark}")
    print(f"Best Subject: {highest_subject} ({subjects[highest_subject]})")
    print(f"Weakest Subject: {lowest_subject} ({subjects[lowest_subject]})")
    with open("student_report.csv", "a", newline="") as file:
        writer = csv.writer(file)
        writer.writerow([name, average, grade, remark, highest_subject, lowest_subject])

    print("\nReport saved to 'student_report.csv'")
grade_student()
